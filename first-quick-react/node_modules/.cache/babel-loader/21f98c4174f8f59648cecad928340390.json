{"ast":null,"code":"var _jsxFileName = \"/Users/yuzhuping/Desktop/first-quick-react/src/App.js\";\nimport React from 'react';\nimport 'rbx/index.css';\nimport { Button, Container, Title } from 'rbx';\nimport { useState } from 'react';\nimport { useEffect } from 'react';\nimport firebase from 'firebase/app';\nimport 'firebase/database';\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDZYzgHjcbC5iZyCXGeopK6tuR2kKVW1Fs\",\n  authDomain: \"first-quick-react.firebaseapp.com\",\n  databaseURL: \"https://first-quick-react.firebaseio.com\",\n  projectId: \"first-quick-react\",\n  storageBucket: \"first-quick-react.appspot.com\",\n  messagingSenderId: \"451507045047\",\n  appId: \"1:451507045047:web:fc1311e5d080d2c3af4332\",\n  measurementId: \"G-F4H6JTV8S3\"\n};\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.database().ref();\nconst schedule = {\n  \"title\": \"CS Courses for 2018-2019\",\n  \"courses\": [{\n    \"id\": \"F101\",\n    \"title\": \"Computer Science: Concepts, Philosophy, and Connections\",\n    \"meets\": \"MWF 11:00-11:50\"\n  }, {\n    \"id\": \"F110\",\n    \"title\": \"Intro Programming for non-majors\",\n    \"meets\": \"MWF 10:00-10:50\"\n  }, {\n    \"id\": \"F111\",\n    \"title\": \"Fundamentals of Computer Programming I\",\n    \"meets\": \"MWF 13:00-13:50\"\n  }, {\n    \"id\": \"F211\",\n    \"title\": \"Fundamentals of Computer Programming II\",\n    \"meets\": \"TuTh 12:30-13:50\"\n  }]\n};\n\nconst Banner = ({\n  title\n}) => /*#__PURE__*/React.createElement(Title, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 3\n  }\n}, title || '[loading...]');\n\nconst buttonColor = selected => selected ? 'success' : null;\n\nconst TermSelector = ({\n  state\n}) => /*#__PURE__*/React.createElement(Button.Group, {\n  hasAddons: true,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 3\n  }\n}, Object.values(terms).map(value => /*#__PURE__*/React.createElement(Button, {\n  key: value,\n  color: buttonColor(value === state.term),\n  onClick: () => state.setTerm(value),\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 9\n  }\n}, value)));\n\nconst CourseList = ({\n  courses\n}) => {\n  const [term, setTerm] = useState('Fall');\n  const [selected, toggle] = useSelection();\n  const termCourses = courses.filter(course => term === getCourseTerm(course));\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(TermSelector, {\n    state: {\n      term,\n      setTerm\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Button.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, termCourses.map(course => /*#__PURE__*/React.createElement(Course, {\n    key: course.id,\n    course: course,\n    state: {\n      selected,\n      toggle\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 37\n    }\n  }))));\n};\n\nconst terms = {\n  F: 'Fall',\n  W: 'Winter',\n  S: 'Spring'\n};\n\nconst getCourseTerm = course => terms[course.id.charAt(0)];\n\nconst getCourseNumber = course => course.id.slice(1, 4);\n\nconst Course = ({\n  course,\n  state\n}) => /*#__PURE__*/React.createElement(Button, {\n  color: buttonColor(state.selected.includes(course)),\n  onClick: () => state.toggle(course),\n  onDoubleClick: () => moveCourse(course),\n  disabled: hasConflict(course, state.selected),\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 3\n  }\n}, getCourseTerm(course), \" CS \", getCourseNumber(course), \": \", course.title);\n\nconst moveCourse = course => {\n  const meets = prompt('Enter new meeting data, in this format:', course.meets);\n  if (!meets) return;\n  const {\n    days\n  } = timeParts(meets);\n  if (days) saveCourse(course, meets);else moveCourse(course);\n};\n\nconst saveCourse = (course, meets) => {\n  db.child('courses').child(course.id).update({\n    meets\n  }).catch(error => alert(error));\n};\n\nconst hasConflict = (course, selected) => selected.some(selection => courseConflict(course, selection));\n\nconst useSelection = () => {\n  const [selected, setSelected] = useState([]);\n\n  const toggle = x => {\n    setSelected(selected.includes(x) ? selected.filter(y => y !== x) : [x].concat(selected));\n  };\n\n  return [selected, toggle];\n};\n\nconst addCourseTimes = course => ({ ...course,\n  ...timeParts(course.meets)\n});\n\nconst addScheduleTimes = schedule => ({\n  title: schedule.title,\n  courses: Object.values(schedule.courses).map(addCourseTimes)\n});\n\nconst meetsPat = /^ *((?:M|Tu|W|Th|F)+) +(\\d\\d?):(\\d\\d) *[ -] *(\\d\\d?):(\\d\\d) *$/;\nconst days = ['M', 'Tu', 'W', 'Th', 'F'];\n\nconst timeParts = meets => {\n  const [match, days, hh1, mm1, hh2, mm2] = meetsPat.exec(meets) || [];\n  return !match ? {} : {\n    days,\n    hours: {\n      start: hh1 * 60 + mm1 * 1,\n      end: hh2 * 60 + mm2 * 1\n    }\n  };\n};\n\nconst daysOverlap = (days1, days2) => days.some(day => days1.includes(day) && days2.includes(day));\n\nconst hoursOverlap = (hours1, hours2) => Math.max(hours1.start, hours2.start) < Math.min(hours1.end, hours2.end);\n\nconst timeConflict = (course1, course2) => daysOverlap(course1.days, course2.days) && hoursOverlap(course1.hours, course2.hours);\n\nconst courseConflict = (course1, course2) => course1 !== course2 && getCourseTerm(course1) === getCourseTerm(course2) && timeConflict(course1, course2);\n\nconst App = () => {\n  const [schedule, setSchedule] = useState({\n    title: '',\n    courses: []\n  });\n  useEffect(() => {\n    const handleData = snap => {\n      if (snap.val()) setSchedule(addScheduleTimes(snap.val()));\n    };\n\n    db.on('value', handleData, error => alert(error));\n    return () => {\n      db.off('value', handleData);\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Banner, {\n    title: schedule.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(CourseList, {\n    courses: schedule.courses,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/yuzhuping/Desktop/first-quick-react/src/App.js"],"names":["React","Button","Container","Title","useState","useEffect","firebase","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","initializeApp","db","database","ref","schedule","Banner","title","buttonColor","selected","TermSelector","state","Object","values","terms","map","value","term","setTerm","CourseList","courses","toggle","useSelection","termCourses","filter","course","getCourseTerm","id","F","W","S","charAt","getCourseNumber","slice","Course","includes","moveCourse","hasConflict","meets","prompt","days","timeParts","saveCourse","child","update","catch","error","alert","some","selection","courseConflict","setSelected","x","y","concat","addCourseTimes","addScheduleTimes","meetsPat","match","hh1","mm1","hh2","mm2","exec","hours","start","end","daysOverlap","days1","days2","day","hoursOverlap","hours1","hours2","Math","max","min","timeConflict","course1","course2","App","setSchedule","handleData","snap","val","on","off"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,eAAP;AACA,SAASC,MAAT,EAAiBC,SAAjB,EAA4BC,KAA5B,QAAyC,KAAzC;AACA,SAASC,QAAT,QAAyB,OAAzB;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,OAAOC,QAAP,MAAqB,cAArB;AACA,OAAO,mBAAP;AAGA,MAAMC,cAAc,GAAG;AACrBC,EAAAA,MAAM,EAAE,yCADa;AAErBC,EAAAA,UAAU,EAAE,mCAFS;AAGrBC,EAAAA,WAAW,EAAE,0CAHQ;AAIrBC,EAAAA,SAAS,EAAE,mBAJU;AAKrBC,EAAAA,aAAa,EAAE,+BALM;AAMrBC,EAAAA,iBAAiB,EAAE,cANE;AAOrBC,EAAAA,KAAK,EAAE,2CAPc;AAQrBC,EAAAA,aAAa,EAAE;AARM,CAAvB;AAUAT,QAAQ,CAACU,aAAT,CAAuBT,cAAvB;AACA,MAAMU,EAAE,GAAGX,QAAQ,CAACY,QAAT,GAAoBC,GAApB,EAAX;AAEA,MAAMC,QAAQ,GAAG;AACf,WAAS,0BADM;AAEf,aAAW,CACT;AACE,UAAM,MADR;AAEE,aAAS,yDAFX;AAGE,aAAS;AAHX,GADS,EAMT;AACE,UAAM,MADR;AAEE,aAAS,kCAFX;AAGE,aAAS;AAHX,GANS,EAWT;AACE,UAAM,MADR;AAEE,aAAS,wCAFX;AAGE,aAAS;AAHX,GAXS,EAgBT;AACE,UAAM,MADR;AAEE,aAAS,yCAFX;AAGE,aAAS;AAHX,GAhBS;AAFI,CAAjB;;AA0BA,MAAMC,MAAM,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,kBACb,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAASA,KAAK,IAAI,cAAlB,CADF;;AAIA,MAAMC,WAAW,GAAGC,QAAQ,IAC1BA,QAAQ,GAAG,SAAH,GAAe,IADzB;;AAIA,MAAMC,YAAY,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,kBACnB,oBAAC,MAAD,CAAQ,KAAR;AAAc,EAAA,SAAS,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GACEC,MAAM,CAACC,MAAP,CAAcC,KAAd,EACGC,GADH,CACOC,KAAK,iBACR,oBAAC,MAAD;AAAQ,EAAA,GAAG,EAAEA,KAAb;AACE,EAAA,KAAK,EAAGR,WAAW,CAACQ,KAAK,KAAKL,KAAK,CAACM,IAAjB,CADrB;AAEE,EAAA,OAAO,EAAG,MAAMN,KAAK,CAACO,OAAN,CAAcF,KAAd,CAFlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAIIA,KAJJ,CAFJ,CADF,CADF;;AAeA,MAAMG,UAAU,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAiB;AAClC,QAAM,CAACH,IAAD,EAAOC,OAAP,IAAkB7B,QAAQ,CAAC,MAAD,CAAhC;AACA,QAAM,CAACoB,QAAD,EAAWY,MAAX,IAAqBC,YAAY,EAAvC;AACA,QAAMC,WAAW,GAAGH,OAAO,CAACI,MAAR,CAAeC,MAAM,IAAIR,IAAI,KAAKS,aAAa,CAACD,MAAD,CAA/C,CAApB;AAEA,sBACE,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAc,IAAA,KAAK,EAAG;AAAER,MAAAA,IAAF;AAAQC,MAAAA;AAAR,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE,oBAAC,MAAD,CAAQ,KAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACIK,WAAW,CAACR,GAAZ,CAAgBU,MAAM,iBAAI,oBAAC,MAAD;AAAQ,IAAA,GAAG,EAAGA,MAAM,CAACE,EAArB;AAA0B,IAAA,MAAM,EAAGF,MAAnC;AAA4C,IAAA,KAAK,EAAG;AAAEhB,MAAAA,QAAF;AAAYY,MAAAA;AAAZ,KAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAA1B,CADJ,CAFF,CADF;AAQD,CAbD;;AAeA,MAAMP,KAAK,GAAG;AAAEc,EAAAA,CAAC,EAAE,MAAL;AAAaC,EAAAA,CAAC,EAAE,QAAhB;AAA0BC,EAAAA,CAAC,EAAE;AAA7B,CAAd;;AAEA,MAAMJ,aAAa,GAAGD,MAAM,IAC1BX,KAAK,CAACW,MAAM,CAACE,EAAP,CAAUI,MAAV,CAAiB,CAAjB,CAAD,CADP;;AAIA,MAAMC,eAAe,GAAGP,MAAM,IAC5BA,MAAM,CAACE,EAAP,CAAUM,KAAV,CAAgB,CAAhB,EAAmB,CAAnB,CADF;;AAIA,MAAMC,MAAM,GAAG,CAAC;AAAET,EAAAA,MAAF;AAAUd,EAAAA;AAAV,CAAD,kBACb,oBAAC,MAAD;AAAQ,EAAA,KAAK,EAAGH,WAAW,CAACG,KAAK,CAACF,QAAN,CAAe0B,QAAf,CAAwBV,MAAxB,CAAD,CAA3B;AACI,EAAA,OAAO,EAAG,MAAMd,KAAK,CAACU,MAAN,CAAaI,MAAb,CADpB;AAEI,EAAA,aAAa,EAAG,MAAMW,UAAU,CAACX,MAAD,CAFpC;AAGI,EAAA,QAAQ,EAAGY,WAAW,CAACZ,MAAD,EAASd,KAAK,CAACF,QAAf,CAH1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAKMiB,aAAa,CAACD,MAAD,CALnB,UAKmCO,eAAe,CAACP,MAAD,CALlD,QAKgEA,MAAM,CAAClB,KALvE,CADF;;AAWE,MAAM6B,UAAU,GAAGX,MAAM,IAAI;AAC3B,QAAMa,KAAK,GAAGC,MAAM,CAAC,yCAAD,EAA4Cd,MAAM,CAACa,KAAnD,CAApB;AACA,MAAI,CAACA,KAAL,EAAY;AACZ,QAAM;AAACE,IAAAA;AAAD,MAASC,SAAS,CAACH,KAAD,CAAxB;AACA,MAAIE,IAAJ,EAAUE,UAAU,CAACjB,MAAD,EAASa,KAAT,CAAV,CAAV,KACKF,UAAU,CAACX,MAAD,CAAV;AACN,CAND;;AAQA,MAAMiB,UAAU,GAAG,CAACjB,MAAD,EAASa,KAAT,KAAmB;AACpCpC,EAAAA,EAAE,CAACyC,KAAH,CAAS,SAAT,EAAoBA,KAApB,CAA0BlB,MAAM,CAACE,EAAjC,EAAqCiB,MAArC,CAA4C;AAACN,IAAAA;AAAD,GAA5C,EACGO,KADH,CACSC,KAAK,IAAIC,KAAK,CAACD,KAAD,CADvB;AAED,CAHD;;AAMF,MAAMT,WAAW,GAAG,CAACZ,MAAD,EAAShB,QAAT,KAClBA,QAAQ,CAACuC,IAAT,CAAcC,SAAS,IAAIC,cAAc,CAACzB,MAAD,EAASwB,SAAT,CAAzC,CADF;;AAIA,MAAM3B,YAAY,GAAG,MAAM;AACzB,QAAM,CAACb,QAAD,EAAW0C,WAAX,IAA0B9D,QAAQ,CAAC,EAAD,CAAxC;;AACA,QAAMgC,MAAM,GAAI+B,CAAD,IAAO;AACpBD,IAAAA,WAAW,CAAC1C,QAAQ,CAAC0B,QAAT,CAAkBiB,CAAlB,IAAuB3C,QAAQ,CAACe,MAAT,CAAgB6B,CAAC,IAAIA,CAAC,KAAKD,CAA3B,CAAvB,GAAuD,CAACA,CAAD,EAAIE,MAAJ,CAAW7C,QAAX,CAAxD,CAAX;AACD,GAFD;;AAGA,SAAO,CAAEA,QAAF,EAAYY,MAAZ,CAAP;AACD,CAND;;AAQA,MAAMkC,cAAc,GAAG9B,MAAM,KAAK,EAChC,GAAGA,MAD6B;AAEhC,KAAGgB,SAAS,CAAChB,MAAM,CAACa,KAAR;AAFoB,CAAL,CAA7B;;AAKA,MAAMkB,gBAAgB,GAAGnD,QAAQ,KAAK;AACpCE,EAAAA,KAAK,EAAEF,QAAQ,CAACE,KADoB;AAEpCa,EAAAA,OAAO,EAAER,MAAM,CAACC,MAAP,CAAcR,QAAQ,CAACe,OAAvB,EAAgCL,GAAhC,CAAoCwC,cAApC;AAF2B,CAAL,CAAjC;;AAMA,MAAME,QAAQ,GAAG,gEAAjB;AACA,MAAMjB,IAAI,GAAG,CAAC,GAAD,EAAM,IAAN,EAAY,GAAZ,EAAiB,IAAjB,EAAuB,GAAvB,CAAb;;AAEA,MAAMC,SAAS,GAAGH,KAAK,IAAI;AACzB,QAAM,CAACoB,KAAD,EAAQlB,IAAR,EAAcmB,GAAd,EAAmBC,GAAnB,EAAwBC,GAAxB,EAA6BC,GAA7B,IAAoCL,QAAQ,CAACM,IAAT,CAAczB,KAAd,KAAwB,EAAlE;AACA,SAAO,CAACoB,KAAD,GAAS,EAAT,GAAc;AACnBlB,IAAAA,IADmB;AAEnBwB,IAAAA,KAAK,EAAE;AACLC,MAAAA,KAAK,EAAEN,GAAG,GAAG,EAAN,GAAWC,GAAG,GAAG,CADnB;AAELM,MAAAA,GAAG,EAAEL,GAAG,GAAG,EAAN,GAAWC,GAAG,GAAG;AAFjB;AAFY,GAArB;AAOD,CATD;;AAWA,MAAMK,WAAW,GAAG,CAACC,KAAD,EAAQC,KAAR,KAClB7B,IAAI,CAACQ,IAAL,CAAUsB,GAAG,IAAIF,KAAK,CAACjC,QAAN,CAAemC,GAAf,KAAuBD,KAAK,CAAClC,QAAN,CAAemC,GAAf,CAAxC,CADF;;AAIA,MAAMC,YAAY,GAAG,CAACC,MAAD,EAASC,MAAT,KACnBC,IAAI,CAACC,GAAL,CAASH,MAAM,CAACP,KAAhB,EAAuBQ,MAAM,CAACR,KAA9B,IAAuCS,IAAI,CAACE,GAAL,CAASJ,MAAM,CAACN,GAAhB,EAAqBO,MAAM,CAACP,GAA5B,CADzC;;AAIA,MAAMW,YAAY,GAAG,CAACC,OAAD,EAAUC,OAAV,KACnBZ,WAAW,CAACW,OAAO,CAACtC,IAAT,EAAeuC,OAAO,CAACvC,IAAvB,CAAX,IAA2C+B,YAAY,CAACO,OAAO,CAACd,KAAT,EAAgBe,OAAO,CAACf,KAAxB,CADzD;;AAIA,MAAMd,cAAc,GAAG,CAAC4B,OAAD,EAAUC,OAAV,KACrBD,OAAO,KAAKC,OAAZ,IACGrD,aAAa,CAACoD,OAAD,CAAb,KAA2BpD,aAAa,CAACqD,OAAD,CAD3C,IAEGF,YAAY,CAACC,OAAD,EAAUC,OAAV,CAHjB;;AAMA,MAAMC,GAAG,GAAG,MAAM;AAChB,QAAM,CAAC3E,QAAD,EAAW4E,WAAX,IAA0B5F,QAAQ,CAAC;AAAEkB,IAAAA,KAAK,EAAE,EAAT;AAAaa,IAAAA,OAAO,EAAE;AAAtB,GAAD,CAAxC;AAEA9B,EAAAA,SAAS,CAAC,MAAM;AACd,UAAM4F,UAAU,GAAGC,IAAI,IAAI;AACzB,UAAIA,IAAI,CAACC,GAAL,EAAJ,EAAgBH,WAAW,CAACzB,gBAAgB,CAAC2B,IAAI,CAACC,GAAL,EAAD,CAAjB,CAAX;AACjB,KAFD;;AAGAlF,IAAAA,EAAE,CAACmF,EAAH,CAAM,OAAN,EAAeH,UAAf,EAA2BpC,KAAK,IAAIC,KAAK,CAACD,KAAD,CAAzC;AACA,WAAO,MAAM;AAAE5C,MAAAA,EAAE,CAACoF,GAAH,CAAO,OAAP,EAAgBJ,UAAhB;AAA8B,KAA7C;AACD,GANQ,EAMN,EANM,CAAT;AAQA,sBACE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAQ,IAAA,KAAK,EAAG7E,QAAQ,CAACE,KAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE,oBAAC,UAAD;AAAY,IAAA,OAAO,EAAGF,QAAQ,CAACe,OAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF;AAMD,CAjBD;;AAmBA,eAAe4D,GAAf","sourcesContent":["import React from 'react';\nimport 'rbx/index.css';\nimport { Button, Container, Title } from 'rbx';\nimport { useState } from 'react';\nimport { useEffect } from 'react';\nimport firebase from 'firebase/app';\nimport 'firebase/database';\n\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDZYzgHjcbC5iZyCXGeopK6tuR2kKVW1Fs\",\n  authDomain: \"first-quick-react.firebaseapp.com\",\n  databaseURL: \"https://first-quick-react.firebaseio.com\",\n  projectId: \"first-quick-react\",\n  storageBucket: \"first-quick-react.appspot.com\",\n  messagingSenderId: \"451507045047\",\n  appId: \"1:451507045047:web:fc1311e5d080d2c3af4332\",\n  measurementId: \"G-F4H6JTV8S3\"\n};\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.database().ref();\n\nconst schedule = {\n  \"title\": \"CS Courses for 2018-2019\",\n  \"courses\": [\n    {\n      \"id\": \"F101\",\n      \"title\": \"Computer Science: Concepts, Philosophy, and Connections\",\n      \"meets\": \"MWF 11:00-11:50\"\n    },\n    {\n      \"id\": \"F110\",\n      \"title\": \"Intro Programming for non-majors\",\n      \"meets\": \"MWF 10:00-10:50\"\n    },\n    {\n      \"id\": \"F111\",\n      \"title\": \"Fundamentals of Computer Programming I\",\n      \"meets\": \"MWF 13:00-13:50\"\n    },\n    {\n      \"id\": \"F211\",\n      \"title\": \"Fundamentals of Computer Programming II\",\n      \"meets\": \"TuTh 12:30-13:50\"\n    }\n  ]\n};\n\nconst Banner = ({ title }) => (\n  <Title>{ title || '[loading...]' }</Title>\n);\n\nconst buttonColor = selected => (\n  selected ? 'success' : null\n);\n\nconst TermSelector = ({ state }) => (\n  <Button.Group hasAddons>\n  { Object.values(terms)\n      .map(value => \n        <Button key={value}\n          color={ buttonColor(value === state.term) }\n          onClick={ () => state.setTerm(value) }\n          >\n          { value }\n        </Button>\n      )\n  }\n  </Button.Group>\n);\n\nconst CourseList = ({ courses }) => {\n  const [term, setTerm] = useState('Fall');\n  const [selected, toggle] = useSelection();\n  const termCourses = courses.filter(course => term === getCourseTerm(course));\n \n  return (\n    <React.Fragment>\n      <TermSelector state={ { term, setTerm } } />\n      <Button.Group>\n        { termCourses.map(course => <Course key={ course.id } course={ course } state={ { selected, toggle } } />) }\n      </Button.Group>\n    </React.Fragment>\n  );\n};\n\nconst terms = { F: 'Fall', W: 'Winter', S: 'Spring'};\n\nconst getCourseTerm = course => (\n  terms[course.id.charAt(0)]\n);\n\nconst getCourseNumber = course => (\n  course.id.slice(1, 4)\n);\n\nconst Course = ({ course, state }) => (\n  <Button color={ buttonColor(state.selected.includes(course)) }\n      onClick={ () => state.toggle(course) }\n      onDoubleClick={ () => moveCourse(course) }\n      disabled={ hasConflict(course, state.selected) }\n      >\n      { getCourseTerm(course) } CS { getCourseNumber(course) }: { course.title }\n    </Button>\n  );\n\n\n  const moveCourse = course => {\n    const meets = prompt('Enter new meeting data, in this format:', course.meets);\n    if (!meets) return;\n    const {days} = timeParts(meets);\n    if (days) saveCourse(course, meets); \n    else moveCourse(course);\n  };\n\n  const saveCourse = (course, meets) => {\n    db.child('courses').child(course.id).update({meets})\n      .catch(error => alert(error));\n  };\n\n\nconst hasConflict = (course, selected) => (\n  selected.some(selection => courseConflict(course, selection))\n);\n\nconst useSelection = () => {\n  const [selected, setSelected] = useState([]);\n  const toggle = (x) => {\n    setSelected(selected.includes(x) ? selected.filter(y => y !== x) : [x].concat(selected))\n  };\n  return [ selected, toggle ];\n};\n\nconst addCourseTimes = course => ({\n  ...course,\n  ...timeParts(course.meets)\n});\n\nconst addScheduleTimes = schedule => ({\n  title: schedule.title,\n  courses: Object.values(schedule.courses).map(addCourseTimes)\n});\n\n\nconst meetsPat = /^ *((?:M|Tu|W|Th|F)+) +(\\d\\d?):(\\d\\d) *[ -] *(\\d\\d?):(\\d\\d) *$/;\nconst days = ['M', 'Tu', 'W', 'Th', 'F'];\n\nconst timeParts = meets => {\n  const [match, days, hh1, mm1, hh2, mm2] = meetsPat.exec(meets) || [];\n  return !match ? {} : {\n    days,\n    hours: {\n      start: hh1 * 60 + mm1 * 1,\n      end: hh2 * 60 + mm2 * 1\n    }\n  };\n};\n\nconst daysOverlap = (days1, days2) => ( \n  days.some(day => days1.includes(day) && days2.includes(day))\n);\n\nconst hoursOverlap = (hours1, hours2) => (\n  Math.max(hours1.start, hours2.start) < Math.min(hours1.end, hours2.end)\n);\n\nconst timeConflict = (course1, course2) => (\n  daysOverlap(course1.days, course2.days) && hoursOverlap(course1.hours, course2.hours)\n);\n\nconst courseConflict = (course1, course2) => (\n  course1 !== course2\n  && getCourseTerm(course1) === getCourseTerm(course2)\n  && timeConflict(course1, course2)\n);\n\nconst App = () => {\n  const [schedule, setSchedule] = useState({ title: '', courses: [] });\n\n  useEffect(() => {\n    const handleData = snap => {\n      if (snap.val()) setSchedule(addScheduleTimes(snap.val()));\n    }\n    db.on('value', handleData, error => alert(error));\n    return () => { db.off('value', handleData); };\n  }, []);\n\n  return (\n    <Container>\n      <Banner title={ schedule.title } />\n      <CourseList courses={ schedule.courses } />\n    </Container>\n);\n};\n\nexport default App;"]},"metadata":{},"sourceType":"module"}